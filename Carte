package View;

import Game.Game;
import Game.Personnage;
import Game.Block;
import Controle.Clavier;

import javax.swing.JFrame;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.KeyListener;
import java.awt.image.ImageObserver;
import java.io.File;
import java.io.IOException;
import javax.imageio.ImageIO;
import javax.swing.JPanel;

public class Carte extends JPanel implements ImageObserver{
	
	private static final int pagehigh = 900;
	private static final int pagelength = 1250;
	private Game game;
	private Clavier clavier;
	
	public Carte(){
		JFrame carte = new JFrame();
		carte.setTitle("projet BA2"); // titre
		carte.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // programme se ferme avec la fenêtre
		carte.setSize(1250, 900); // met la taille
		carte.setLocation(300,50); // met l'emplacement
		carte.setVisible(true); // affiche la fênetre
		carte.setResizable(false); // empêche le redimensionnement
		carte.setAlwaysOnTop(false); // pas d'office en premier plan
		carte.setLayout(null);
		carte.setContentPane(this);
		this.setFocusable(true);            // on peut intéragir avec
		this.requestFocusInWindow();        // si la page du dessus, c'est celle qui sera active
		draw();
		game = new Game(this);
		clavier = new Clavier(game);
		setKeyListener(clavier);
				
	}
	public void draw(){
		repaint();
	}
	
	public void paint(Graphics g){
		try{
			int taille = game.getdimension();
			Image perso = ImageIO.read(new File("perso.jpg"));
			Image fond = ImageIO.read(new File("fondmap.jpg"));
			Image bloc = ImageIO.read(new File("bloc.jpg"));
			g.drawImage(fond, 0, 0,pagelength, pagehigh, this); //met l'image tout en haut a gauche avec la meme taille que le cadre
		for (Personnage personnage : game.getpersonnages()){
			g.drawImage(perso, pagelength*personnage.getposX()/taille, pagehigh*personnage.getposY()/taille,pagelength/taille, pagehigh/taille, this); //met l'image tout en haut a gauche avec la meme taille que le cadre
		}//insérer les images en attributs pour que plus propre
		for (Block block : game.getblocks()){
			g.drawImage(bloc, pagelength*block.getposX()/taille, pagehigh*block.getposY()/taille,pagelength/taille, pagehigh/taille, this); //met l'image tout en haut a gauche avec la meme taille que le cadre
		}
		
	}catch(IOException e){
		e.printStackTrace(); 
	}
	}
	
	
	public void setKeyListener(KeyListener keyboard){
	    addKeyListener(keyboard);
	    
	}

}
